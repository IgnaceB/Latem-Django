{%load static%}
<!DOCTYPE html>
<html lang="en">
<head>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
        
	    <link rel="stylesheet" type="text/css" href="{% static 'css/devis.css' %}">
        <script src="{% static 'script/devis.js' %}" defer></script>
        {{data|json_script}}
     
	<title>Escaliers</title>
</head>
<body>
	<div class="wrapper">
		<header>
			<div class="logo" id="logo">
				<img src="{% static 'assets/logo.png' %}">
			</div>
			 <nav>
                <div id="menu">
                    <ul>
                        <li>
                            <a href="{% url 'home' %}">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" class="w-6 h-6">
                                  <path d="M11.47 3.84a.75.75 0 011.06 0l8.69 8.69a.75.75 0 101.06-1.06l-8.689-8.69a2.25 2.25 0 00-3.182 0l-8.69 8.69a.75.75 0 001.061 1.06l8.69-8.69z" />
                                  <path d="M12 5.432l8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 01-.75-.75v-4.5a.75.75 0 00-.75-.75h-3a.75.75 0 00-.75.75V21a.75.75 0 01-.75.75H5.625a1.875 1.875 0 01-1.875-1.875v-6.198a2.29 2.29 0 00.091-.086L12 5.43z" />
                              </svg>

                          </a>
                      </li>
                      <li>
                        <a href="{% url 'contact' %}">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" class="w-6 h-6">
                              <path d="M1.5 8.67v8.58a3 3 0 003 3h15a3 3 0 003-3V8.67l-8.928 5.493a3 3 0 01-3.144 0L1.5 8.67z" />
                              <path d="M22.5 6.908V6.75a3 3 0 00-3-3h-15a3 3 0 00-3 3v.158l9.714 5.978a1.5 1.5 0 001.572 0L22.5 6.908z" />
                          </svg>

                      </a>
                  </li>
                  <li>
                    <a href="{% url 'configurateur' %}">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" class="w-6 h-6">
                          <path d="M18.75 12.75h1.5a.75.75 0 000-1.5h-1.5a.75.75 0 000 1.5zM12 6a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5A.75.75 0 0112 6zM12 18a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5A.75.75 0 0112 18zM3.75 6.75h1.5a.75.75 0 100-1.5h-1.5a.75.75 0 000 1.5zM5.25 18.75h-1.5a.75.75 0 010-1.5h1.5a.75.75 0 010 1.5zM3 12a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5A.75.75 0 013 12zM9 3.75a2.25 2.25 0 100 4.5 2.25 2.25 0 000-4.5zM12.75 12a2.25 2.25 0 114.5 0 2.25 2.25 0 01-4.5 0zM9 15.75a2.25 2.25 0 100 4.5 2.25 2.25 0 000-4.5z" />
                      </svg>

                  </a>
              </li>
              <li>
                <a href="{% url 'account' %}">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" class="w-6 h-6">
                      <path fill-rule="evenodd" d="M18.685 19.097A9.723 9.723 0 0021.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 003.065 7.097A9.716 9.716 0 0012 21.75a9.716 9.716 0 006.685-2.653zm-12.54-1.285A7.486 7.486 0 0112 15a7.486 7.486 0 015.855 2.812A8.224 8.224 0 0112 20.25a8.224 8.224 0 01-5.855-2.438zM15.75 9a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" clip-rule="evenodd" />
                  </svg>

              </a>
          </li>
      </ul>
  </div>
</nav>
		</header>
        <section>
        <table border="1" id='tableDevis'>
        <tr>
            <th>N°devis</th>
            <th colspan=2 >Statut du devis</th>
            <th class='date'>Date</th>
            <th colspan=2 style='width:20%'></th>

        </tr>
        <tr>
            <td data-id id='devis_id'>{{ data.devis.id }}</td>
            <td data-status class='inputContainer' colspan=2>
                <select name="status" id='status'>
               {% for choice_key, choice_label in forms.updateDevisStatusForm.fields.status.choices %}
                    <option value="{{ choice_key }}" {% if choice_key == data.devis.status %}selected{% endif %}>{{ choice_label }}</option>
                {% endfor %}
            </select>
            </td>
            <td data-created-at id='date'>{{ data.devis.created_at }}</td>
            <td></td>
            <td onclick="afficherDeleteFormulaire(this,'devis')" >
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="red" class="w-6 h-6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />
                </svg>

            </td>
            
        </tr>

                 <tr>
                <th colspan=3>Type d'objet</th>
                <th colspan>Q</th>
                <th style="background:white"></th>
                <th onclick="afficherAddFormulaire(this,'item')" style="background:white">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="4" stroke="green" class="w-6 h-6" style="background : white">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                    </svg>

                </th>
                
           
            </tr>
        {% for ligne in data.lignesItems %}

            {%if ligne.textCustom is not None%}
                 <tr ligneItemId='{{ligne.id}}'>
                        <td data-item-name colspan=3 >{{ ligne.textCustom }}</td>
                        <td data-quantity class='quantite' onkeydown="afficherModifyFormulaire(event,this,'item')"><input type='number' value='{{ ligne.quantity }}' pattern="[0-9]"></td>
                        <td onclick="afficherDeleteFormulaire(this,'item')">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="red" class="w-6 h-6">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />
                            </svg>

                        </td>
                        <td onclick="afficherAddFormulaire(this,'description')">
                              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="4" stroke="green" class="w-6 h-6">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                            </svg>
                        </td>
                    </tr>
                
            {%else%}
                {%for items in data.items %}
                    {%if items.id == ligne.itemId %}
                        <tr ligneItemId='{{ligne.id}}'>
                            <td data-item-name colspan=3>{{ items.name }}</td>
                            <td data-quantity class='quantite' onkeydown="afficherModifyFormulaire(event, this,'item')"><input type='number' value='{{ ligne.quantity }}' pattern="[0-9]"></td>
                            <td onclick="afficherDeleteFormulaire(this,'item')">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="red" class="w-6 h-6">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />
                                </svg>
                            </td>
                            <td onclick="afficherAddFormulaire(this,'description')">
                                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="4" stroke="green" class="w-6 h-6">
                                      <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                                    </svg>
                            </td>
                        </tr>
                     
                    {%endif%}
                {% endfor %}
            {%endif%}
                 
            {% for levelLignesDesc in data.lignesDescription %}
                {%for lignesDesc in levelLignesDesc%}
                    {%if lignesDesc.LignesItemsDevisId == ligne.id %}
                        {%if lignesDesc.textCustom is not None%}
                            <tr ligneDescId='{{lignesDesc.id}}' ligneItemId='{{ligne.id}}'>
                                <td></td>
                                <td data-description-name colspan=3>{{ lignesDesc.textCustom }}</td>
                                <td onclick="afficherDeleteFormulaire(this,'description')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="red" class="w-6 h-6">
                                      <path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />
                                    </svg>
                                </td>
                                <td onclick="afficherModifyFormulaire(event, this,'description')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                                      <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3" />
                                    </svg>

                                </td>
                            </tr>
                        {%else%}
                            {% for desc in data.description %}
                                {% if lignesDesc.descriptionItems == desc.id %}
                                    <tr ligneDescId='{{lignesDesc.id}}' ligneItemId='{{ligne.id}}'>
                                        <td></td>
                                        <td data-description-name colspan=3>{{ desc.name }}</td>
                                        <td onclick="afficherDeleteFormulaire(this,'description')">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="red" class="w-6 h-6">
                                              <path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />
                                            </svg>

                                        </td>
                                        <td onclick="afficherModifyFormulaire(event,this,'description')">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                                      <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3" />
                                    </svg>
                                        </td>
                                    </tr>
                                {% endif %}
                            {% endfor %}
                        {%endif%}
                    {%endif%}
                {%endfor%}
            {%endfor%}
        {% endfor %}
        <tr>
            <th colspan=3>Total </th>
            <td data-quantity class='quantite' onkeydown="afficherModifyFormulaire(event, this,'devis')" colspan=2><input type='number' value='{{ data.devis.total }}' id='total'>
            </td>
            <td>€</td>
        </tr>

    </table>
</section>
<section>
    <h2>Client</h2>
    <table border="1">
        <tr>
            <th>ID du client</th>
            <th>Nom du client</th>
            <th>Email du client</th>
        </tr>
        <tr>
            <td data-client-id>{{ data.client.id }}</td>
            <td data-client-name>{{ data.client.firstName }} {{ data.client.lastName }}</td>
            <td data-client-email>{{ data.client.email }}</td>
        </tr>
    </table>
</section>
        <div class="subNav">
        <a href="{% url 'dashboard' %}">
            <button>Dashboard</button></a>
    <a href="{{dropboxUrl}}" target="_blank"><button>DropBox</button></a>
</div>
<div class="subNav">

        <a href="{% url 'dashboard' %}">
            <button>Envoyer Email Devis</button></a>
</div>
    <form id='suppressionForms' method='POST'>
        {% csrf_token %}
    {{forms.descriptionSuppressionForm}}

<input type="submit" style='display:none'>
</form>
    <form id='updateDescriptionForm' method='POST'>
    {% csrf_token %}
    {{forms.updateDescriptionForm}}
<input type="submit" style='display:none'>

</form>
    <form id='addDescriptionForm' method='POST'>
    {% csrf_token %}
    {{forms.addDescriptionForm}}
<input type="submit" style='display:none'>
</form>
    <form id='updateDevisStatusForm' method='POST'>
    {% csrf_token %}
    {{forms.updateDevisStatusForm}}
<input type="submit" style='display:none'>


</form>
    <form id='updateQuantityForm' method='POST'>
    {% csrf_token %}
    {{forms.updateQuantityForm}}
<input type="submit" style='display:none'>
</form>
    <form id='createLineItemForm' method='POST'>
    {% csrf_token %}
    {{forms.createLineItemForm}}
<input type="submit" style='display:none'>
</form>
    <form id='deleteDevisForm' method='POST'>
    {% csrf_token %}
    {{forms.deleteDevisForm}}
<input type="submit" style='display:none'>
</form>
</body>

<footer>
</footer>
</div>	
</html>